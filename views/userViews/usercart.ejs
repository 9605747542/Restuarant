<!doctype html>
<html class="no-js" lang="zxx">
<head>
<meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<title>Shop | eCommerce</title>
<meta name="description" content>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="manifest" href="site.webmanifest">
<link rel="shortcut icon" type="image/x-icon" href="assets/img/favicon.ico">
<style>
  /* Style for the increment and decrement buttons */
  .input-number-decrement-btn:hover, .input-number-increment-btn:hover {
    opacity: 0.8;
}

.input-number {
    outline: none;
}


</style>

<link rel="stylesheet" href="/assets/css/bootstrap.min.css">
<link rel="stylesheet" href="/assets/css/owl.carousel.min.css">
<link rel="stylesheet" href="/assets/css/slicknav.css">
<link rel="stylesheet" href="/assets/css/flaticon.css">
<link rel="stylesheet" href="/assets/css/progressbar_barfiller.css">
<link rel="stylesheet" href="/assets/css/lightslider.min.css">
<link rel="stylesheet" href="/assets/css/price_rangs.css">
<link rel="stylesheet" href="/assets/css/gijgo.css">
<link rel="stylesheet" href="/assets/css/animate.min.css">
<link rel="stylesheet" href="/assets/css/animated-headline.css">
<link rel="stylesheet" href="/assets/css/magnific-popup.css">
<link rel="stylesheet" href="/assets/css/fontawesome-all.min.css">
<link rel="stylesheet" href="/assets/css/themify-icons.css">
<link rel="stylesheet" href="/assets/css/slick.css">
<link rel="stylesheet" href="/assets/css/nice-select.css">
<link rel="stylesheet" href="/assets/css/style.css">
</head>
<body>



<header>

<div class="header-area">
<div class="main-header header-sticky">
<div class="container-fluid">
<div class="row menu-wrapper align-items-center justify-content-between">
<div class="header-left d-flex align-items-center">

<div class="logo">
<a href="index.html"><img src="assets/img/logo/logo.png" alt></a>
</div>

<div class="logo2">
<a href="index.html"><img src="assets/img/logo/logo2.png" alt></a>
</div>

<div class="main-menu  d-none d-lg-block">
<nav>
<ul id="navigation">
<li><a href="index.html">Home</a></li>
<li><a href="product.html">Product</a></li>
<li><a href="about.html">About</a></li>
<li><a href="#">Page</a>
<ul class="submenu">
<li><a href="login.html">Login</a></li>
<li><a href="card.html">Card</a></li>
<li><a href="categories.html">Categories</a></li>
<li><a href="checkout.html">Checkout</a></li>
<li><a href="product_details.html">Product Details</a></li>
</ul>
</li>
<li><a href="blog.html">Blog</a>
<ul class="submenu">
<li><a href="blog.html">Blog</a></li>
<li><a href="blog_details.html">Blog Details</a></li>
<li><a href="elements.html">Elements</a></li>
</ul>
</li>
<li><a href="contact.html">Contact</a></li>
</ul>
</nav>
</div>
</div>
<div class="header-right1 d-flex align-items-center">
<div class="search">
<ul class="d-flex align-items-center">
<li>

<form action="#" class="form-box f-right ">
<input type="text" name="Search" placeholder="Search products">
<div class="search-icon">
<i class="ti-search"></i>
</div>
</form>
</li>
<li>
<a href="login.html" class="account-btn" target="_blank">My Account</a>
</li>
<li>
<div class="card-stor">
<img src="assets/img/icon/card.svg" alt>
<span>0</span>
</div>
</li>
</ul>
</div>
</div>

<div class="col-12">
<div class="mobile_menu d-block d-lg-none"></div>
</div>
</div>
</div>
</div>
</div>

</header>
<main>

<div class="slider-area ">
<div class="slider-active">
<div class="single-slider hero-overly2  slider-height2 d-flex align-items-center slider-bg2">
<div class="container">
<div class="row">
<div class="col-xl-6 col-lg-8 col-md-8">
<div class="hero__caption hero__caption2">
<h1 data-animation="fadeInUp" data-delay=".4s">Cart List</h1>
<nav aria-label="breadcrumb">
<ol class="breadcrumb">
<li class="breadcrumb-item"><a href="index.html">Home</a></li>
<li class="breadcrumb-item"><a href="#">Cart List</a></li>
</ol>
</nav>
</div>
</div>
</div>
</div>
</div>
</div>
</div>


<section class="cart_area section-padding40">
<div class="container">
<div class="cart_inner">
<div class="table-responsive">
<table class="table" id="cartTable">
<thead>
<tr>
<th scope="col">Product</th>
<th scope="col">Price</th>
<th scope="col">Quantity</th>
<th scope="col">Total</th>
<th scope="col">Actions</th>
</tr>
</thead>
<tbody>
  <%for(let i=0;i< datas.length;i++){%>
<tr class="product" data-id="<%= datas[i]._id %>">
  

  
<td>

<div class="media">
<div class="d-flex">
<img style="transition: 10ms;" src="<%=datas[i].image[0]%>" alt="">
</div>
<div class="media-body">
<p><%=datas[i].productName%></p>
</div>
</div>
</td>
<td>
<h5> $<span id="price<%=datas[i]._id%>"><%=datas[i].price%></span></h5>
</td>
<td>
    <div class="product_count" style="display: flex; align-items: center; gap: 5px;">
        <button class="input-number-decrement-btn" onclick="changeQuantity('<%= datas[i]._id %>', -1)" style="background-color: #ff4d4d; color: white; border: none; cursor: pointer; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; border-radius: 5px;" id="decrement<%= datas[i]._id %>">-</button>
        
        <input class="input-number" id="quantity<%=datas[i]._id%>" type="text" value="<%=datas[i].quantity%>" min="0" max="10" style="width: 50px; height: 30px; text-align: center; font-size: 14px; border: 1px solid #ccc; border-radius: 5px;">

    
        <button class="input-number-increment-btn" onclick="changeQuantity('<%= datas[i]._id %>', 1)" style="background-color: #4CAF50; color: white; border: none; cursor: pointer; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; border-radius: 5px;" id="increment<%= datas[i]._id %>">+</button>
    </div>
    
  
    

</td>
<td>

<h5> $<span id="subtotal<%=datas[i]._id%>">0</span></h5>
</td>
<td>
  <button class="btn w-10 " onclick="removeItem('<%= datas[i]._id %>')" data-animation="fadeInUp" >Remove</button>
  </td>


</tr>
<%}%>



<tr class="bottom_button">
<td>
<a class="btn" href="#">Update Cart</a>
</td>
<td></td>
<td></td>
<td>

</td>
</tr>
<tr>
<td></td>
<td></td>
<td>
<h5>Total</h5>
</td>
<td>
<h5 class="subtotal"> $<span id="total">0</span></h5>
</td>
</tr>

</tbody>
</table>
<div class="checkout_btn_inner float-right">
<a class="btn" href="/getuserproduct">Continue Shopping</a>
<a class="btn checkout_btn" href="/getcheckout">Proceed to checkout</a>
</div>
</div>
</div>
</div>
</section>


<div class="categories-area section-padding40 gray-bg">
<div class="container">
<div class="row">
<div class="col-lg-3 col-md-6 col-sm-6">
<div class="single-cat mb-50 wow fadeInUp" data-wow-duration="1s" data-wow-delay=".2s">
<div class="cat-icon">
<img src="assets/img/icon/services1.svg" alt>
</div>
<div class="cat-cap">
<h5>Fast & Free Delivery</h5>
<p>Free delivery on all orders</p>
</div>
</div>
</div>
<div class="col-lg-3 col-md-6 col-sm-6">
<div class="single-cat mb-50 wow fadeInUp" data-wow-duration="1s" data-wow-delay=".2s">
<div class="cat-icon">
<img src="assets/img/icon/services2.svg" alt>
</div>
<div class="cat-cap">
<h5>Secure Payment</h5>
<p>Free delivery on all orders</p>
</div>
</div>
</div>
<div class="col-lg-3 col-md-6 col-sm-6">
<div class="single-cat mb-50 wow fadeInUp" data-wow-duration="1s" data-wow-delay=".4s">
<div class="cat-icon">
<img src="assets/img/icon/services3.svg" alt>
</div>
<div class="cat-cap">
<h5>Money Back Guarantee</h5>
<p>Free delivery on all orders</p>
</div>
</div>
</div>
<div class="col-lg-3 col-md-6 col-sm-6">
<div class="single-cat mb-50 wow fadeInUp" data-wow-duration="1s" data-wow-delay=".5s">
<div class="cat-icon">
<img src="assets/img/icon/services4.svg" alt>
</div>
<div class="cat-cap">
<h5>Online Support</h5>
<p>Free delivery on all orders</p>
</div>
</div>
</div>
</div>
</div>
</div>

</main>
<footer>
<div class="footer-wrapper">

<div class="footer-area footer-padding">
<div class="container ">
<div class="row justify-content-between">
<div class="col-xl-4 col-lg-3 col-md-8 col-sm-8">
<div class="single-footer-caption mb-50">
<div class="single-footer-caption mb-30">

<div class="footer-logo mb-35">
<a href="index.html"><img src="assets/img/logo/logo2_footer.png" alt></a>
</div>
<div class="footer-tittle">
<div class="footer-pera">
<p>Suspendisse varius enim in eros elementum tristique. Duis cursus, mi quis viverra ornare, eros dolor interdum nulla.</p>
</div>
</div>

<div class="footer-social">
<a href="#"><i class="fab fa-twitter"></i></a>
<a href="https://bit.ly/sai4ull"><i class="fab fa-facebook-f"></i></a>
<a href="#"><i class="fab fa-pinterest-p"></i></a>
</div>
</div>
</div>
</div>
<div class="col-xl-2 col-lg-2 col-md-4 col-sm-4">
<div class="single-footer-caption mb-50">
<div class="footer-tittle">
<h4>Quick links</h4>
<ul>
<li><a href="#">Image Licensin</a></li>
<li><a href="#">Style Guide</a></li>
<li><a href="#">Privacy Policy</a></li>
</ul>
</div>
</div>
</div>
<div class="col-xl-2 col-lg-2 col-md-4 col-sm-4">
<div class="single-footer-caption mb-50">
<div class="footer-tittle">
<h4>Shop Category</h4>
<ul>
<li><a href="#">Image Licensin</a></li>
<li><a href="#">Style Guide</a></li>
<li><a href="#">Privacy Policy</a></li>
</ul>
</div>
</div>
</div>
<div class="col-xl-2 col-lg-2 col-md-4 col-sm-4">
<div class="single-footer-caption mb-50">
<div class="footer-tittle">
<h4>Pertners</h4>
<ul>
<li><a href="#">Image Licensin</a></li>
<li><a href="#">Style Guide</a></li>
<li><a href="#">Privacy Policy</a></li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>

<div class="footer-bottom-area">
<div class="container">
<div class="footer-border">
<div class="row d-flex align-items-center">
<div class="col-xl-12 ">
<div class="footer-copy-right text-center">
<p>
Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="fa fa-heart" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib</a>
</p>
</div>
</div>
</div>
</div>
</div>
</div>

</div>
</footer>

<div id="back-top">
<a title="Go to Top" href="#"> <i class="fas fa-level-up-alt"></i></a>
</div>
<script>
  document.addEventListener('DOMContentLoaded', function() {
  document.querySelectorAll('.product').forEach(product => {
        console.log("blaaa909");
        let productId = product.querySelector('input[type="text"]').id.replace('quantity', '');
        let quantity = parseInt(document.getElementById('quantity' + productId).value);
        console.log("blaaa");
        updateSubtotal(productId, quantity);
    });
});



 async function changeQuantity(productId, change) {
    console.log(productId);
    let quantityInput = document.getElementById('quantity' + productId);
    let newQuantity = parseInt(quantityInput.value) + change;
   let total = document.getElementById('total').innerText;
    console.log(total);
    if (newQuantity >= 0) { // Ensure the quantity never goes below 0
        quantityInput.value = newQuantity;
        const formData={
            quantity:newQuantity,
            proId:productId,
            total:total
        }
       
        const response= await fetch('/changequantity',{
            method:'POST',
            headers:{
                'Content-Type':'application/json'
            },
            body:JSON.stringify(formData)

        })
        const data= await response.json();
        console.log("data from backend",data);
        if(data.success===true){
            console.log("Quantity updated successfully");
            updateSubtotal(productId, newQuantity);
        }else{
            console.log("error");
            
        }



         // Update this product's subtotal
    }
}

function updateSubtotal(productId, quantity) {
    console.log("hello");
    let price = parseFloat(document.getElementById('price' + productId).innerText);
    let subtotal = quantity * price;
    document.getElementById('subtotal' + productId).innerText = subtotal.toFixed(2);
    updateTotal(); // Update the total whenever any subtotal changes
}

function updateTotal() {
    let total = 0;
    document.querySelectorAll('.product').forEach(product => {
        let subtotalText = product.querySelector('[id^="subtotal"]').innerText;
        let subtotal = parseFloat(subtotalText);
        total += subtotal;
    });
    console.log("Total amount",total);
    document.getElementById('total').innerText = total.toFixed(2);
}


//for remove cart item
function removeItem(itemId) {
  const row = document.querySelector(`tr[data-id="${itemId}"]`);
  fetch(`/removeitemfromcart/${itemId}`, {
        method: 'DELETE',
      })
      .then(response => {
        if (response.ok) {
          // Remove the row from the table
          row.remove();

        } else {
          console.error('Failed to remove item from cart');
        }
      })
      .catch(error => {
        console.error('Error removing item from cart:', error);
      });
    }


 
  







</script>

<script src="./assets/js/vendor/modernizr-3.5.0.min.js"></script>
<script src="./assets/js/vendor/jquery-1.12.4.min.js"></script>
<script src="./assets/js/popper.min.js"></script>
<script src="./assets/js/bootstrap.min.js"></script>

<script src="./assets/js/owl.carousel.min.js"></script>
<script src="./assets/js/slick.min.js"></script>
<script src="./assets/js/jquery.slicknav.min.js"></script>

<script src="./assets/js/wow.min.js"></script>
<script src="./assets/js/animated.headline.js"></script>
<script src="./assets/js/jquery.magnific-popup.js"></script>
<script src="./assets/js/gijgo.min.js"></script>

<script src="./assets/js/jquery.nice-select.min.js"></script>
<script src="./assets/js/jquery.sticky.js"></script>
<script src="./assets/js/jquery.barfiller.js"></script>

<script src="./assets/js/jquery.counterup.min.js"></script>
<script src="./assets/js/waypoints.min.js"></script>
<script src="./assets/js/jquery.countdown.min.js"></script>
<script src="./assets/js/hover-direction-snake.min.js"></script>

<script src="./assets/js/contact.js"></script>
<script src="./assets/js/jquery.form.js"></script>
<script src="./assets/js/jquery.validate.min.js"></script>
<script src="./assets/js/mail-script.js"></script>
<script src="./assets/js/jquery.ajaxchimp.min.js"></script>

<script src="./assets/js/plugins.js"></script>
<script src="./assets/js/main.js"></script>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-23581568-13"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-23581568-13');
</script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/v84a3a4012de94ce1a686ba8c167c359c1696973893317" integrity="sha512-euoFGowhlaLqXsPWQ48qSkBSCFs3DPRyiwVu3FjR96cMPx+Fr+gpWRhIafcHwqwCqWS42RZhIudOvEI+Ckf6MA==" data-cf-beacon='{"rayId":"85441fb34ad929f3","b":1,"version":"2024.2.0","token":"cd0b4b3a733644fc843ef0b185f98241"}' crossorigin="anonymous"></script>
</body>
</html>